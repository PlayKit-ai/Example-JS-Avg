<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸…ç†æ¸¸æˆç¼“å­˜</title>
    <link rel="icon" type="image/png" href="styles/spray_i358.PNG">
    <link rel="shortcut icon" type="image/png" href="styles/spray_i358.PNG">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .button:hover {
            background: #0056b3;
        }
        .button.danger {
            background: #dc3545;
        }
        .button.danger:hover {
            background: #c82333;
        }
        .info {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #007bff;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§¹ æ¸¸æˆç¼“å­˜æ¸…ç†å·¥å…·</h1>
        
        <div class="info">
            <strong>è¯´æ˜ï¼š</strong><br>
            å¦‚æœæ¸¸æˆå‡ºç°é‡å¤å›å¤æˆ–å¼‚å¸¸è¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨æ­¤å·¥å…·æ¸…ç†ç¼“å­˜ã€‚
        </div>

        <button class="button" onclick="clearDialogueHistory()">
            ğŸ—¨ï¸ æ¸…ç†å¯¹è¯å†å²
        </button>

        <button class="button" onclick="clearImageCache()">
            ğŸ–¼ï¸ æ¸…ç†å›¾åƒç¼“å­˜
        </button>

        <button class="button" onclick="clearGameState()">
            ğŸ® æ¸…ç†æ¸¸æˆçŠ¶æ€
        </button>

        <button class="button danger" onclick="clearAllData()">
            ğŸ—‘ï¸ æ¸…ç†æ‰€æœ‰æ•°æ®ï¼ˆé‡ç½®æ¸¸æˆï¼‰
        </button>

        <button class="button" onclick="showCacheInfo()">
            ğŸ“Š æŸ¥çœ‹ç¼“å­˜ä¿¡æ¯
        </button>

        <div id="result"></div>
    </div>

    <script>
        // å­˜å‚¨é”®åï¼ˆä¸æ¸¸æˆä¸­ä¿æŒä¸€è‡´ï¼‰
        const STORAGE_KEYS = {
            PLAYER_PROFILE: 'ai_galgame_player_profile',
            AI_PROFILE: 'ai_galgame_ai_profile',
            DIALOGUE_HISTORY: 'ai_galgame_dialogue_history',
            GAME_STATE: 'ai_galgame_game_state',
            CHARACTER_IMAGE_CACHE: 'ai_galgame_character_images',
            BACKGROUND_IMAGE_CACHE: 'ai_galgame_background_images',
            LAST_PLAY_TIME: 'ai_galgame_last_play_time'
        };

        function showResult(message, isSuccess = true) {
            const result = document.getElementById('result');
            result.className = isSuccess ? 'success' : 'info';
            result.innerHTML = message;
        }

        function clearDialogueHistory() {
            try {
                localStorage.removeItem(STORAGE_KEYS.DIALOGUE_HISTORY);
                showResult('âœ… å¯¹è¯å†å²å·²æ¸…ç†ï¼<br>ç°åœ¨å¯ä»¥é‡æ–°å¼€å§‹å¯¹è¯äº†ã€‚');
            } catch (error) {
                showResult('âŒ æ¸…ç†å¯¹è¯å†å²å¤±è´¥: ' + error.message, false);
            }
        }

        function clearImageCache() {
            try {
                localStorage.removeItem(STORAGE_KEYS.CHARACTER_IMAGE_CACHE);
                localStorage.removeItem(STORAGE_KEYS.BACKGROUND_IMAGE_CACHE);
                showResult('âœ… å›¾åƒç¼“å­˜å·²æ¸…ç†ï¼<br>ä¸‹æ¬¡æ¸¸æˆæ—¶ä¼šé‡æ–°ç”Ÿæˆå›¾åƒã€‚');
            } catch (error) {
                showResult('âŒ æ¸…ç†å›¾åƒç¼“å­˜å¤±è´¥: ' + error.message, false);
            }
        }

        function clearGameState() {
            try {
                localStorage.removeItem(STORAGE_KEYS.GAME_STATE);
                localStorage.removeItem(STORAGE_KEYS.LAST_PLAY_TIME);
                showResult('âœ… æ¸¸æˆçŠ¶æ€å·²æ¸…ç†ï¼<br>ä¸‹æ¬¡å¯åŠ¨æ—¶éœ€è¦é‡æ–°è®¾ç½®è§’è‰²ã€‚');
            } catch (error) {
                showResult('âŒ æ¸…ç†æ¸¸æˆçŠ¶æ€å¤±è´¥: ' + error.message, false);
            }
        }

        function clearAllData() {
            if (!confirm('ç¡®å®šè¦æ¸…ç†æ‰€æœ‰æ•°æ®å—ï¼Ÿè¿™å°†é‡ç½®æ•´ä¸ªæ¸¸æˆï¼')) {
                return;
            }

            try {
                Object.values(STORAGE_KEYS).forEach(key => {
                    localStorage.removeItem(key);
                });
                showResult('âœ… æ‰€æœ‰æ•°æ®å·²æ¸…ç†ï¼<br>æ¸¸æˆå·²å®Œå…¨é‡ç½®ï¼Œè¯·åˆ·æ–°é¡µé¢é‡æ–°å¼€å§‹ã€‚');
            } catch (error) {
                showResult('âŒ æ¸…ç†æ‰€æœ‰æ•°æ®å¤±è´¥: ' + error.message, false);
            }
        }

        function showCacheInfo() {
            let info = '<strong>ğŸ“Š å½“å‰ç¼“å­˜ä¿¡æ¯ï¼š</strong><br><br>';
            let totalSize = 0;

            Object.entries(STORAGE_KEYS).forEach(([name, key]) => {
                const data = localStorage.getItem(key);
                if (data) {
                    const size = new Blob([data]).size;
                    totalSize += size;
                    info += `${name}: ${(size / 1024).toFixed(2)} KB<br>`;
                } else {
                    info += `${name}: æ— æ•°æ®<br>`;
                }
            });

            info += `<br><strong>æ€»å¤§å°: ${(totalSize / 1024).toFixed(2)} KB</strong>`;
            showResult(info, false);
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºç¼“å­˜ä¿¡æ¯
        window.onload = function() {
            showCacheInfo();
        };
    </script>
</body>
</html>